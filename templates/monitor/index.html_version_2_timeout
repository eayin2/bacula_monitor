{% comment %} Example dictionaries:
{ phlap01linw-fd : { Full-LT-Copies-02: [18, '22.05.15 02:33', 21, 255493], Full-LT: [18, '22.03.15 01:10', 51, 26593], } }
client_pool_dict:
{'"phlap01winw-fd"': {'Incremental-ST', 'Incremental-LT', 'Full-ST', 'Full-LT'},
  'phserver01-fd': {'Incremental-ST', 'Full-ST'},
  '"phlap01linw-fd"': {'Incremental-ST', 'Incremental-LT', 'Full-ST', 'Full-LT'}}
copy_dependency_dict:
{'Incremental-LT': {'Incremental-LT-Copies-01', 'Incremental-LT-Copies-02'}, 'Full-LT': {'Full-LT-Copies-02', 'Full-LT-Copies-01'}}


    <li><span class="up">{{ hkey }}</span></li>
{% endcomment %}

<html>
  <head>
    <link rel="stylesheet" href="/static/styles/styles.css">
    <title>Bacula-monitor</title>
  </head>
<body>
<div class="content">
<h2>Bacula-monitor</h2>

<div class="c_flex">
{% comment %} We iterate the config pools for the client, that should be backuped and see if there actually were. {% endcomment %}

{% for skey, svalue in jobs_should.items %}
{% comment %} key is our client {% endcomment %}
<section class="c">

  {% for hkey, hvalue in hosts.items %}
  {% if skey == hkey %}
    {% for el in hvalue|slice:"1:" %}
      {% if el == 1 %}
        <h4 class="up">{{ skey }}</h4>
      {% elif el == 0 %}
        <h4 class="down">{{ skey }}</h4>
      {% endif %}
    {% endfor %}
  {% endif %}
  {% endfor %}

<table>
  <tr>
    <th>Pool</th>
    <th>Size (GB)</th>
    <th>Ended</th>
    <th>Duration (mins)</th>
    <th>Files (#)</th>
    <th>Timeout</th>
  </tr>
  {% comment %} iterating the list of pools of the client here. {% endcomment %}
  {% for svalue2 in svalue %}
  <tr>
    {% comment %} here we iterate over our actual jobs and do a if condition when we found the client job result in our config client.{% endcomment %}
    {% for jkey, jvalue in jobs.items %}
      {% if skey == jkey %}
        {% comment %} here we check if "pool from should exist (config)"(svalue2) is in jvalue (dict with pool-keys of client). {% endcomment %}
        {% if not svalue2 in jvalue %}
          <tr>
            <td style="color: red;">{{ svalue2 }}</td>
          </tr>
        {% else %}
          <tr>


            {% for jkey2, jvalue2 in jvalue.items %}
              {% comment %} here we compare pools. {% endcomment %}
              {% if svalue2 == jkey2 %}
            {% if jvalue2.4 == 1 %}
            <td style="color: yellow;">{{ svalue2 }}</td>
            {% elif jvalue2.4 == 0 %}
            <td style="color: green;">{{ svalue2 }}</td>
            {% endif %}


                {% for jvalue3 in jvalue2 %}
                  {% if forloop.counter == 5 %}
                    {% if jvalue3 == 1 %}
                      <td style="color: yellow;">OLD</td>
                    {% else %}
                      <td style="color: green;">OK</td>
                    {% endif %}
                  {% else %}
                    <td><span>{{ jvalue3 }}</span></td>
                  {% endif %}
                {% endfor %}
              {% endif %}
            {% endfor %}
          </tr>
        {% endif %}
      {% endif %}
    {% endfor %} {% comment %} endfor of jobs.items  {% endcomment %}
  </tr>
  {% endfor %} {% comment %} endfor of svalue  {% endcomment %}
</table>
</section>
{% endfor %}  {% comment %} endfor of jobs_should.items  {% endcomment %}
</div>

</div>
</body>
</html>
